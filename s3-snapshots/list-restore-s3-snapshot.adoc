---
sidebar: sidebar 
permalink: s3-snapshots/list-restore-s3-snapshot.html 
keywords: s3 snapshots, list, restore, browse S3 snapshots 
summary: O recurso de snapshot do ONTAP S3 permite exibir, navegar e restaurar o conteúdo de snapshot do S3 para seus buckets de clientes do S3. 
---
= Visualize e restaure snapshots do ONTAP S3
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
A partir do ONTAP 9.16.1, você pode visualizar e navegar pelos dados de snapshots do S3 para seus buckets a partir de clientes S3.  A partir do ONTAP 9.18.1, o bucket de snapshots do S3 pode ser acessado nativamente com a CLI do ONTAP .  Além disso, você pode restaurar um único objeto, um conjunto de objetos ou um bucket inteiro em um cliente S3 a partir de um snapshot do S3.

.Antes de começar
* Todos os nós do cluster devem estar executando o ONTAP 9.18.1 ou posterior para que você possa executar a operação de restauração de snapshot de bucket nativamente na CLI do ONTAP .  A partir do ONTAP 9.18.1, o navegador S3 não é mais necessário, mas as operações ainda são suportadas.
* Apenas uma operação de restauração de snapshot é permitida por vez em um determinado bucket.


.Sobre esta tarefa
A partir do ONTAP 9.16.1, o recurso de snapshots do ONTAP S3 fornece funcionalidades básicas de snapshot para buckets do ONTAP S3, incluindo criação e exclusão manual e agendada de snapshots, políticas de snapshot para buckets do S3 e navegação de snapshots baseada em cliente S3.

A partir do ONTAP 9.18.1, foi adicionado suporte para restauração nativa de snapshots do ONTAP , fornecendo aos administradores do ONTAP a funcionalidade de restauração para um ponto específico no tempo sem a necessidade de usar um navegador S3.  Apenas a versão atual do bucket é capturada no snapshot.  O histórico de versões não é capturado e não será restaurado pela operação de restauração de snapshot do S3.



== Liste e e visualize instantâneos S3D.

Você pode visualizar os detalhes do snapshot do S3, compará-los e identificar erros. Usando a CLI do ONTAP, você pode listar todos os snapshots criados nos buckets do S3.

.Passos
. Listar S3 instantâneos:
+
[listing]
----
vserver object-store-server bucket snapshot show
----
+
Você pode visualizar os nomes dos snapshots, as VMs de armazenamento, os buckets, os horários de criação e os UUIDs das instâncias dos snapshots do S3 criados para todos os seus buckets no cluster.

. Você também pode especificar o nome de um bucket para visualizar os nomes, horários de criação e UUIDs de instância de todos os snapshots do S3 criados para esse bucket específico.
+
[listing]
----
vserver object-store-server bucket snapshot show -vserver <svm_name> -bucket <bucket_name>
----




== PESQUISE conteúdo de instantâneos S3

Se você notar falhas ou problemas no seu ambiente, poderá navegar pelo conteúdo dos snapshots do bucket do S3 para identificar os erros. Você também pode navegar nos snapshots S3 para determinar o conteúdo livre de erros a ser restaurado.

Os snapshots do S3 são apresentados como buckets de snapshots para os clientes do S3.  O nome do bucket de snapshots está formatado como `<base_bucket_name>-s3snap-<snapshot_name>` .  Você pode visualizar todos os buckets de snapshots em uma VM de armazenamento usando o `ListBuckets` Operação da API S3.

O bucket de snapshots do S3 herda as políticas de acesso do bucket base e suporta apenas operações de leitura.  Operações de exclusão e gravação são proibidas.  Se você tiver permissões para acessar o bucket base, também poderá executar operações de API do S3 somente leitura no bucket de snapshot do S3, como: `HeadObject` , `GetObject` , `GetObjectTagging` , `ListObjects` , `ListObjectVersions` , `GetObjectAcl` , e `CopyObject` .


NOTE: A `CopyObject` operação é suportada em um bucket de instantâneos do S3 somente se for um snapshot do bucket de origem, e não se for o destino de armazenamento do snapshot.

Para obter mais informações sobre essas operações, link:../s3-config/ontap-s3-supported-actions-reference.html["Ações compatíveis com o ONTAP S3"]consulte .



== Restaurar um bucket a partir de snapshots do S3 usando o ONTAP

A partir do ONTAP 9.18.1, você pode usar a CLI do ONTAP para restaurar um bucket inteiro usando um snapshot do ONTAP S3.  Você só pode restaurar a versão do bucket que existia no momento em que o snapshot selecionado foi criado.

.Passos
. Identifique o snapshot que deseja usar para restaurar o bucket:
+
[listing]
----
vserver object-store-server bucket snapshot show
----
. Restaure o balde:
+
[listing]
----
vserver object-store-server bucket snapshot restore start -vserver <storage VM name> -bucket <bucket name> -snapshot <snapshot name>
----




== Restaurar dados de snapshots de buckets S3 usando um cliente S3

Além de restaurar um bucket inteiro no ONTAP, você também pode restaurar um único objeto, um conjunto de objetos ou um bucket inteiro a partir de um snapshot do S3 usando um cliente S3 como o S3cmd ou o S3 Browser.

link:index.html#snapshots-on-versioned-and-non-versioned-buckets["Saiba mais sobre snapshots versionados e não versionados."]

Você pode restaurar o bucket inteiro, objetos com um determinado prefixo ou um único objeto usando o `aws s3 cp` comando.

.Passos
. Tire um instantâneo do balde base S3.
+
[source, cli]
----
vserver object-store-server bucket snapshot create -vserver <svm_name> -bucket <base_bucket_name> -snapshot <snapshot_name>
----
. Restaure o bucket da base usando o snapshot:
+
** Restaure um balde inteiro. Use o nome do bucket do instantâneo no formato `<base_bucket_name>-s3snap-<snapshot_name>`.
+
[source, cli]
----
aws --endpoint http://<IP> s3 cp s3://<snapshot-bucket-name> s3://<base-bucket>  --recursive
----
** Restaure objetos em um diretório com o prefixo `dir1`:
+
[source, cli]
----
aws --endpoint http://<IP> s3 cp s3://<snapshot-bucket-name>/dir1 s3://<base_bucket_name>/dir1 --recursive
----
** Restaurar um único objeto chamado `web.py`:
+
[source, cli]
----
aws --endpoint http://<IP> s3 cp s3:// <snapshot-bucket-name>/web.py s3://<base_bucket_name>/web.py
----



